@prefix : <https://w3id.org/semts/ontology#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix dcat: <http://www.w3.org/ns/dcat#> .
@prefix qudt: <http://qudt.org/schema/qudt#> .
@prefix qudtUnit: <http://qudt.org/vocab/unit/> .
@prefix time: <http://www.w3.org/2006/time#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix mls: <http://www.w3.org/ns/mls#> .
@prefix bm: <https://w3id.org/semts/examples/blowmolding/> .
@prefix semts-dv: <https://w3id.org/semts/vocabulary/data-knowledge#> .
@prefix semts-sv: <https://w3id.org/semts/vocabulary/scenario-knowledge#> .
@prefix mlso-em: <http://w3id.org/mlso/vocab/evaluation_measure#> .
@prefix mlso-algo: <http://w3id.org/mlso/vocab/ml_algorithm#> .

#################################################################
# Knowledge Generation Entities für manuelle/Expert-Eingaben
#################################################################

bm:ExpertAnnotation a :KnowledgeReasoning ;
    :title "Expert Domain Annotation" ;
    :description "Manual annotation by domain expert" ;
    :knowledgeGenerationConcept bm:ManualAnnotationConcept ;
    :used bm:ExpertAnnotationInput ;
    :generated bm:ExpertAnnotationOutput .

bm:ManualAnnotationConcept a :KnowledgeGenerationConcept ;
    skos:prefLabel "Manual Expert Annotation"@en .

bm:ExpertAnnotationInput a :KnowledgeGenerationInput ;
    :title "Expert Knowledge Input" ;
    :inputDataReference bm:BlowMoldingTimeSeries .

bm:ExpertAnnotationOutput a :KnowledgeGenerationOutput ;
    :title "Expert Knowledge Output" ;
    :wasDerivedFrom bm:ExpertAnnotationInput ;
    :outputKnowledge bm:DefaultCycleTime ;
    :outputKnowledge bm:TempSpikeCharacteristic .

#################################################################
# Time Series Segments (korrigiert: time:Interval statt time:DateTimeInterval)
#################################################################

bm:BlowMoldingTimeSeries a :TimeSeriesSegment ;
    :title "Complete Blow Molding Process Dataset" ;
    :description "Process data from a blow molding machine over 30 days with 1-second sampling rate" ;
    :segmentIndex bm:BlowMoldingTimeSeriesIndex ;
    :segmentDimension bm:TemperatureDimension ;
    :segmentDimension bm:PressureDimension ;
    :segmentDimension bm:CycleDimension ;
    :segmentDimension bm:VibrationDimension ;
    :segmentKnowledge bm:DefaultCycleTime ;
    :segmentKnowledge bm:PressureAnomaly ;
    :segmentKnowledge bm:AutoencoderModel ;
    dcat:distribution [
        a dcat:Distribution ;
        dcat:downloadURL <localhost/data/blow_molding_data_2023.csv> ;
        dcat:mediaType "text/csv"
    ] .

bm:BlowMoldingTimeSeriesIndex a time:Interval ;
    time:hasBeginning [
        a time:Instant ;
        time:inXSDDateTime "2023-01-01T00:00:00Z"^^xsd:dateTime
    ] ;
    time:hasEnd [
        a time:Instant ;
        time:inXSDDateTime "2023-01-30T23:59:59Z"^^xsd:dateTime
    ] .

bm:DailySegment_20230115 a :TimeSeriesSegment ;
    :title "Daily Segment from January 15, 2023" ;
    :isPartOf bm:BlowMoldingTimeSeries ;
    :segmentIndex bm:DailySegment_20230115_Index ;
    :segmentDimension bm:TemperatureDimension ;
    :segmentDimension bm:PressureDimension ;
    :segmentDimension bm:CycleDimension ;
    :segmentDimension bm:VibrationDimension ;
    dcat:distribution [
        a dcat:Distribution ;
        dcat:downloadURL <localhost/data/blow_molding_data_20230115.csv> ;
        dcat:mediaType "text/csv"
    ] .

bm:DailySegment_20230115_Index a time:Interval ;
    time:hasBeginning [
        a time:Instant ;
        time:inXSDDateTime "2023-01-15T00:00:00Z"^^xsd:dateTime
    ] ;
    time:hasEnd [
        a time:Instant ;
        time:inXSDDateTime "2023-01-15T23:59:59Z"^^xsd:dateTime
    ] .

#################################################################
# Data Dimensions (korrigiert: :hasUnit statt :hasqudtUnit)
#################################################################

bm:TemperatureDimension a :DataDimension ;
    :title "Temperature" ;
    :description "Temperature in the blow molding machine" ;
    :dimensionPosition 0 ;
    :hasUnit qudtUnit:DEG_C ;
    :hasDatatype qudt:FLOAT .

bm:PressureDimension a :DataDimension ;
    :title "Pressure" ;
    :description "Pressure in the blow molding chamber" ;
    :dimensionPosition 1 ;
    :hasUnit qudtUnit:BAR ;
    :hasDatatype qudt:FLOAT .

bm:CycleDimension a :DataDimension ;
    :title "Cycle Duration" ;
    :description "Duration of a blow molding cycle" ;
    :dimensionPosition 2 ;
    :hasUnit qudtUnit:SEC ;
    :hasDatatype qudt:FLOAT .

bm:VibrationDimension a :DataDimension ;
    :title "Vibration" ;
    :description "Vibration intensity in the machine" ;
    :dimensionPosition 3 ;
    :hasUnit qudtUnit:MilliM-PER-SEC ;
    :hasDatatype qudt:FLOAT .

#################################################################
# Scenario Knowledge (korrigiert: knowledgeGenerationEntity hinzugefügt)
#################################################################

bm:DefaultCycleTime a :ScenarioKnowledge ;
    :title "Default Cycle Time" ;
    :description "Standard production cycle time for the blow molding machine" ;
    :knowledgeConcept semts-sv:ScenarioParameter ;
    :knowledgeGenerationEntity bm:ExpertAnnotation ;
    :hasValue [
        a :EmbeddedValue ;
        :valueString "42" ;
        :hasUnit qudtUnit:SEC ;
        :hasDatatype qudt:FLOAT
    ] .

bm:TempSpikeCharacteristic a :ScenarioKnowledge ;
    :title "Temperature Spike Characteristic" ;
    :description "Unallowed operating range" ;
    :knowledgeConcept semts-sv:Observation ;
    :knowledgeGenerationEntity bm:ExpertAnnotation ;
    :hasValue [
        a :EmbeddedValue ;
        :valueString "24.7" ;
        :hasUnit qudtUnit:DEG_C ;
        :hasDatatype qudt:FLOAT
    ] .

#################################################################
# Knowledge Generation Method
#################################################################

bm:AutoencoderAnalysis a :KnowledgeGenerationMethod ;
    :title "Autoencoder for Anomaly Detection" ;
    :description "Unsupervised anomaly detection using autoencoder reconstruction error" ;
    :knowledgeGenerationConcept mlso-algo:AutoEncoder ;
    :used bm:AutoencoderInput ;
    :generated bm:AutoencoderOutput .

bm:AutoencoderInput a :KnowledgeGenerationInput ;
    :title "Input Data for Autoencoder" ;
    :inputDataReference bm:BlowMoldingTimeSeries .

bm:AutoencoderOutput a :KnowledgeGenerationOutput ;
    :title "Results of Autoencoder Analysis" ;
    :wasDerivedFrom bm:AutoencoderInput ;
    :outputKnowledge bm:AutoencoderModel ;
    :outputKnowledge bm:PressureAnomaly .

#################################################################
# Data Knowledge (korrigiert: hasValue hinzugefügt)
#################################################################

bm:AutoencoderModel a :ModelInstance ;
    :title "Trained Autoencoder Model" ;
    :description "Trained autoencoder model for anomaly detection in blow molding process data" ;
    :knowledgeConcept semts-dv:ModelInstance ;
    :knowledgeGenerationEntity bm:AutoencoderAnalysis ;
    :hasValue [
        a :ReferencedValue ;
        :hasDatatype qudt:BYTE ;
        dcat:distribution [
            a dcat:Distribution ;
            dcat:downloadURL <localhost/models/autoencoder_blowmolding_v1.h5> ;
            dcat:mediaType "application/x-hdf5"
        ]
    ] .

bm:PressureAnomaly a :SegmentPrediction ;
    :title "Pressure Anomaly" ;
    :description "Anomalies in the pressure dimension detected through high reconstruction error" ;
    :knowledgeConcept semts-dv:Anomaly ;
    :knowledgeGenerationEntity bm:AutoencoderAnalysis ;
    :knowledgeQualityMeasure bm:ReconstructionErrorMeasure ;
    :hasValue [
        a :EmbeddedValue ;
        :valueString "true" ;
        :hasDatatype qudt:BOOLEAN
    ] .

#################################################################
# Quality Measure
#################################################################

bm:ReconstructionErrorMeasure a :KnowledgeQualityMeasure ;
    :title "Reconstruction Error" ;
    :description "RMSE-based reconstruction error for the detected anomalies" ;
    :qualityMeasureConcept mlso-em:root_mean_squared_error ;
    :hasValue [
        a :EmbeddedValue ;
        :valueString "0.0342" ;
        :hasDatatype qudt:FLOAT
    ] .

#################################################################
# Anomaly Segments
#################################################################

bm:AnomalySegment_20230115_0842 a :TimeSeriesSegment ;
    :title "Anomaly Segment at 2023-01-15 08:42" ;
    :isPartOf bm:DailySegment_20230115 ;
    :segmentIndex [
        a time:Interval ;
        time:hasBeginning [
            a time:Instant ;
            time:inXSDDateTime "2023-01-15T08:42:00Z"^^xsd:dateTime
        ] ;
        time:hasEnd [
            a time:Instant ;
            time:inXSDDateTime "2023-01-15T08:47:30Z"^^xsd:dateTime
        ]
    ] ;
    :segmentDimension bm:PressureDimension ;
    :segmentKnowledge bm:PressureAnomaly ;
    :segmentKnowledge bm:TempSpikeCharacteristic ;
    dcat:distribution [
        a dcat:Distribution ;
        dcat:downloadURL <localhost/data/anomaly_20230115_0842.csv> ;
        dcat:mediaType "text/csv"
    ] .

bm:AnomalySegment_20230115_1435 a :TimeSeriesSegment ;
    :title "Anomaly Segment at 2023-01-15 14:35" ;
    :isPartOf bm:DailySegment_20230115 ;
    :segmentIndex [
        a time:Interval ;
        time:hasBeginning [
            a time:Instant ;
            time:inXSDDateTime "2023-01-15T14:35:00Z"^^xsd:dateTime
        ] ;
        time:hasEnd [
            a time:Instant ;
            time:inXSDDateTime "2023-01-15T14:38:45Z"^^xsd:dateTime
        ]
    ] ;
    :segmentDimension bm:PressureDimension ;
    :segmentKnowledge bm:PressureAnomaly ;
    dcat:distribution [
        a dcat:Distribution ;
        dcat:downloadURL <localhost/data/anomaly_20230115_1435.csv> ;
        dcat:mediaType "text/csv"
    ] .
